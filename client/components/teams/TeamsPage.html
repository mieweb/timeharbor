<template name="teams">
  <h3 class="text-xl font-semibold mb-4">Teams</h3>
  {{#if selectedTeam}}
    <div class="card bg-base-100 shadow-xl p-6 mb-6">
      <button id="backToTeams" class="btn btn-outline mb-6">&larr; Back to Teams</button>
      
      <!-- Team Header -->
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-primary mb-1">{{selectedTeam.name}}</h2>
        <p class="text-base-content opacity-70">Team Details & Management</p>
      </div>

      <!-- Team Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div class="stat bg-base-200 rounded-lg p-4">
          <div class="stat-title">Team Members</div>
          <div class="stat-value text-primary">{{selectedTeam.members.length}}</div>
          <div class="stat-desc">Active collaborators</div>
        </div>
        <div class="stat bg-base-200 rounded-lg p-4">
          <div class="stat-title">Join Code</div>
          <div class="stat-value text-lg font-mono">{{selectedTeam.code}}</div>
          <div class="stat-desc">Share to invite members</div>
        </div>
        <div class="stat bg-base-200 rounded-lg p-4">
          <div class="stat-title">Status</div>
          <div class="stat-value text-success">Active</div>
          <div class="stat-desc">Team is operational</div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold mb-3">Quick Actions</h3>
        <div class="flex flex-wrap gap-3">
          <button id="copyTeamCode" class="btn btn-primary">
            <i class="fa-solid fa-copy mr-2"></i>Copy Join Code
          </button>
          <button class="btn btn-outline">
            <i class="fa-solid fa-share mr-2"></i>Share Team
          </button>
          <button class="btn btn-outline">
            <i class="fa-solid fa-chart-bar mr-2"></i>View Analytics
          </button>
        </div>
      </div>

      <!-- Team Members -->
      <div>
        <h3 class="text-lg font-semibold mb-3">Team Members</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
          {{#each selectedTeam.members}}
            <div class="card bg-base-200 p-3">
              <div class="flex items-center gap-3">
                <div class="avatar placeholder">
                  <div class="bg-primary text-primary-content rounded-full w-10">
                    <span class="text-sm">{{#if this.name}}{{substring this.name 0 2}}{{else}}UN{{/if}}</span>
                  </div>
                </div>
                <div>
                  <div class="font-semibold">{{#if this.name}}{{this.name}}{{else}}{{this.email}}{{/if}}</div>
                  <div class="text-xs opacity-70">{{#if this.email}}{{this.email}}{{else}}No email{{/if}}</div>
                </div>
              </div>
            </div>
          {{/each}}
        </div>
      </div>
    </div>
  {{else}}
    <div class="flex gap-4 mb-4">
      <button id="showCreateTeamForm" class="btn btn-primary">Create Team</button>
      <button id="showJoinTeamForm" class="btn btn-outline">Join Team</button>
    </div>
    {{#if showCreateTeam}}
      <form id="createTeamForm" class="card bg-base-100 shadow p-4 mb-4 flex flex-col gap-2">
        <input type="text" name="teamName" placeholder="Team Name" class="input input-bordered" required />
        <div class="flex gap-2">
          <button type="submit" class="btn btn-primary">Create</button>
          <button type="button" id="cancelCreateTeam" class="btn btn-outline">Cancel</button>
        </div>
      </form>
    {{/if}}
    {{#if showJoinTeam}}
      <form id="joinTeamForm" class="card bg-base-100 shadow p-4 mb-4 flex flex-col gap-2">
        <input type="text" name="teamCode" placeholder="Enter Team Code" class="input input-bordered" required />
        <div class="flex gap-2">
          <button type="submit" class="btn btn-outline">Join</button>
          <button type="button" id="cancelJoinTeam" class="btn btn-outline">Cancel</button>
        </div>
      </form>
    {{/if}}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {{#each userTeams}}
        <div class="card bg-base-100 shadow p-4">
          <div class="flex items-center justify-between">
            <a href="#" class="link team-link text-lg font-semibold flex-1" data-id="{{_id}}">{{name}}</a>
            {{#if canManageTeam _id}}
              <div class="flex gap-1 ml-2">
                <button class="rename-team-btn btn btn-ghost btn-xs" data-id="{{_id}}" title="Edit Team Name">
                  <i class="fa-solid fa-pen text-primary"></i>
                </button>
                <button class="delete-team-btn btn btn-ghost btn-xs text-red-600 hover:text-red-800" data-id="{{_id}}" title="Delete Team">
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>
            {{/if}}
          </div>
        </div>
      {{/each}}
    </div>
  {{/if}}
</template>

